<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="utf-8">
    <title>HardwareLife</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

    <link rel="stylesheet" href="../../css/styleFuncionario.css">
    <script src="../../js/sessao.js"></script>
</head>

<!-- <body> -->

<body onload=" validarSessao(), listar()">

    <div class="navbar" id="navbar">
        <div class="container_sidebar">
            <span id="side-bar-deactive">X</span>
            <div class="logo">
                <img src="../../assets/index/logo.svg" alt="Logo HardwareLife">
                <h1>HardwareLife</h1>
            </div>
        </div>
        <div class="sidebar">
            <!-- <div class='perfil'>
                    <div class="img_perfil"><img src="../../src/perfil/amazon.jfif" alt="profile"></div>
                    <span>Amazon.com, Inc</span>
                </div> -->
            <div class="link_part">
                <span class="link" style="display: none;">
                    <img src="../../assets/dashboard/icon_config.svg" alt="configurações">
                    <a href="">Perfil</a>
                </span>
                <span class="link">
                    <img src="../../assets/dashboard/door.svg" alt="dashboard">
                    <a href="../dashboard.html">Salas</a>
                </span>
                <!-- <span class="link">
                        <img src="../../assets/dashboard/icon_dashboard.svg" alt="dashboard">
                        <a href="../dashboard.html">Dashboard</a>
                    </span> -->
                <span class="link">
                    <img src="../../assets/dashboard/icon_logout.svg" alt="logo">
                    <a href="../../loginCadastro.html">Sair</a>
                </span>

            </div>
        </div>
        <!-- <a onclick="aparecerModal()" style="margin-left: 20px; cursor: pointer;">Alerta</a> -->
    </div>
    <div class="header">
        <div class="container">
            <div class="side-bar" id="side-bar-active">
                <i class="fa fa-align-justify"></i>
                <div class="logo" id="container">
                    <img src="../../assets/dashboard/logo.svg" alt="Logo HardwareLife">
                    <h1>HardwareLife</h1>
                </div>
            </div>

            <div class="usuario_perfil">
                <h1>Olá,<span id="nome_usuario"></span></h1>
            </div>
        </div>
    </div>
    <div class="container2">
        <article class="card">
            <div class='background'>
                <img src="../../assets/perfil/amazon.jfif" alt="profile">
            </div>
            <div class='content'>
                <h2 id="nome_empresa"></h2>

                <div class="resum">
                    <h3>Informações:</h3>
                    <span><img src="../../assets/perfil/globo.svg" alt="icone">Brasil</span>
                    <span><img src="../../assets/perfil/location.svg" alt="icone">Jundiai - São Paulo</span>
                    <span><img src="../../assets/perfil/phone.svg" alt="icone">(11) 4296-2589</span>
                    <span><img src="../../assets/perfil/emai.svg" alt="icone">amazon@hardwarelife.com</span>
                    <button class="button_perfil" onclick="mudarCard()" id="botao_perfil">Editar Perfil</button>
                    <button class="button_perfil" onclick="voltarCard()" id="botao_voltar"
                        style="display: none;">Voltar</button>
                </div>

            </div>
        </article>
        <article class="card-secund" id="card_secund">
            <form action="" class="formulario_cadastro" onsubmit="return false">
                <span class="titulo_cadastro" id="titulo_cadastro">Cadastrar Novo Gestor:</span>
                <span class="campos_cadastros" id="campos_cadastros">
                    <div class="campo">
                        <label for="nome_funcionario">Nome:</label>
                        <input type="text" id="nome_funcionario" placeholder="Nome Funcionario">
                    </div>
                    <div class="campo">
                        <label for="nome_funcionario">Sobrenome:</label>
                        <input type="text" id="sobrenome_funcionario" placeholder="Sobrenome Funcionario">
                    </div>
                    <div class="campo">
                        <label for="nome_funcionario">CPF:</label>
                        <input type="text" id="cpf_funcionario" placeholder="Cpf Funcionario">
                    </div>
                    <div class="campo">
                        <label for="nome_funcionario">Email:</label>
                        <input type="email" id="email_funcionario" placeholder="Email Funcionario">
                    </div>
                    <div class="campo">
                        <label for="nome_funcionario">Senha:</label>
                        <input type="password" id="senha_funcionario" placeholder="Senha Funcionario">
                    </div>
                    <!-- <div class="campo" id="campo_unidade">
                        <label for="unidade">Unidade:</label>
                        <select name="escolha_unidade" id="escolha_unidade">
                            <option value="0"></option>
                            <option value="1">Jundiai</option>
                            <option value="2">Campo</option>
                        </select>
                    </div> -->
                </span>
                <button class="btn_form_cadastro" onclick="cadastrar()">Cadastrar</button>
            </form>
            
            <div class="lista_funcionario" id="lista">
                <div class="legendas">
                    <p>Nome</p>
                    <p>Email</p>
                    <p>Nível</p>
                </div>
            </div>

        </article>

        <article class="card-secund" id="card_endereco" style="display: none;">
            <form action="" class="formulario_cadastro cadastro_perfil">
                <span class="titulo_cadastro" id="titulo_cadastro">Cadastrar Informações do Perfil:</span>
                <span class="campos_cadastros" id="campos_cadastros">
                    <div class="campo">
                        <label for="nome_usuario">Nome:</label>
                        <input type="text" id="nome_usuario" placeholder="Nome">
                    </div>
                    <div class="campo">
                        <label for="sobrenome_usuario">Sobrenome:</label>
                        <input type="text" id="sobrenome_usuario" placeholder="Sobrenome">
                    </div>
                    <div class="campo">
                        <label for="cpf_usuario">CPF:</label>
                        <input type="text" id="cpf_usuario" placeholder="Cpf">
                    </div>
                    <div class="campo">
                        <label for="email_usuario">Email:</label>
                        <input type="email" id="email_usuario" placeholder="Email">
                    </div>
                    <div class="campo">
                        <label for="senha_usuario">Senha:</label>
                        <input type="password" id="senha_usuario" placeholder="Senha">
                    </div>
                    <div class="campo" id="campo_razao">
                        <label for="razaoSocial">Razão Social da Empresa:</label>
                        <input type="text" id="razaoSocial_empresa" placeholder="Razão Social da Empresa">
                    </div>
                    <button class="btn_form_cadastro" onclick="editarPerfil()">Cadastrar</button>
                </span>

            </form>
            <div class="formulario_cadastro" style="padding-top: 0; ">
                <span class="titulo_cadastro" id="titulo_cadastro">Cadastrar Informações de Endereço:</span>
                <span class="campos_cadastros" id="campos_cadastros">
                    <div class="campo">
                        <label for="logradouro">Rua:</label>
                        <input type="text" id="rua_datacenter" placeholder="Rua">
                    </div>
                    <div class="campo">
                        <label for="numero_usuario">Número:</label>
                        <input type="text" id="numero_usuario" placeholder="número">
                    </div>
                    <div class="campo">
                        <label for="bairro_usuario">Bairro:</label>
                        <input type="text" id="bairro_usuario" placeholder="Bairro">
                    </div>
                    <div class="campo">
                        <label for="cidade_usuario">Cidade:</label>
                        <input type="text" id="cidade_usuario" placeholder="Cidade">
                    </div>
                    <div class="campo">
                        <label for="uf_usuario">UF:</label>
                        <input type="text" id="uf_usuario" placeholder="UF">
                    </div>
                    <div class="campo" id="campo_razao">
                        <label for="cep">CEP:</label>
                        <input type="text" id="cep_empresa" placeholder="Cep">
                    </div>
                    <button class="btn_form_cadastro" onclick="cadastrarEndereco()">Cadastrar</button>
                </span>
            </div>

        </article>
    </div>
</body>
<script>
    nome_usuario.innerHTML = sessionStorage.NOME_USUARIO;
    nome_empresa.innerHTML = sessionStorage.NOME_EMPRESA;
    var nivel = sessionStorage.TIPO_NIVEL;
    var informacaoSala = JSON.parse(sessionStorage.SALAS);
    var funcionarioDataCenter = []

    var activeSideBar = document.getElementById("side-bar-active");
    var deactiveSideBar = document.getElementById("side-bar-deactive");

    activeSideBar.addEventListener("click", function () {
        navbar.style.display = "flex";
        container.style.visibility = "hidden";
    })

    deactiveSideBar.addEventListener("click", function () {
        navbar.style.display = "none";
        container.style.visibility = "visible";
    });

    function listar() {
        var idDatacenter = informacaoSala[0].fkDatacenter;

        fetch(`/usuarios/listar/${idDatacenter}`)
        .then(function (resultado) {
              
        }).catch(function (resultado) {
            
        });
    }

    setTimeout(() => {
        console.log("Entrando no timeout")

        for(var i = 0; i < funcionarioDataCenter.length; i++){
             
            lista.innerHTML += `<div class="lista_item">
                    <div class="item_nome">${funcionarioDataCenter[i].nome}</div>
                    <div class="item_nome">${funcionarioDataCenter[i].email}</div>
                    <div class="item_nome">${funcionarioDataCenter[i].tipoNivel}</div>
                </div>`;
        }

    }, 500)

    // function validarNivel() {
    //     if (nivel == "CEO") {
    //         campo_unidade.style.display = "flex";
    //     }else {
    //         card_secund.innerHTML += "Q MENTIRA"
    //     }
    // }

    function cadastrar() {
        var idUsuario = sessionStorage.ID_USUARIO;
        var idDatacenter = informacaoSala[0].fkDatacenter;
        var nomeFunc = nome_funcionario.value;
        var sobrenomeFunc = nome_funcionario.value;
        var cpfFunc = cpf_funcionario.value;
        var emailFunc = email_funcionario.value;
        var senhaFunc = senha_funcionario.value;
        console.log(idDatacenter, informacaoSala)
        if (nomeFunc === "" || sobrenomeFunc === "" || cpfFunc === ""
            || emailFunc === "" || senhaFunc === "") {
            return false;
        } else {
            // setTimeout(() => {
            // meuModal.style.display = "none";
            // }, 6000);
        }

        fetch("/usuarios/cadastrar", {
            method: "POST",
            headers: {
                "Content-Type": "application/json",
            },
            body: JSON.stringify({
                nomeServer: nomeFunc,
                sobrenomeServer: sobrenomeFunc,
                cpfServer: cpfFunc,
                emailServer: emailFunc,
                senhaServer: senhaFunc,
                nivelServer: nivel,
                fkSuperiorServer: idUsuario,
                fkDataCenterServer: idDatacenter

            }),
        })

            .then(function (resposta) {
                console.log("resposta: ", resposta);

                //     if (resposta.ok) {
                //     // meuModal.style.display = "block";

                //     successMessage.style.display = "block";

                //     setTimeout(() => { signin() }, "1000");

                //     // limparFormulario();
                //     // finalizarAguardar();
                // } else {
                //     throw "Houve um erro ao tentar realizar o cadastro!";
                //     // meuModal.style.display = "block";
                //     erroMessage.style.display = "block";
                //     // successMessage.innerHTML = `${json.mensagem}`;
                // }

            })
            .catch(function (resultado) {
                console.log(`#ERRO: ${resultado}`);
            });

        return false;
    }

    function mudarCard() {
        card_secund.style.display = "none";
        // card_endereco.style.transition = "2s";
        card_endereco.style.display = "flex";
        botao_perfil.style.display = "none";
        botao_voltar.style.display = "flex";
    }

    function voltarCard() {
        card_secund.style.display = "flex";
        // card_endereco.style.transition = "2s";
        card_endereco.style.display = "none";
        botao_perfil.style.display = "flex";
        botao_voltar.style.display = "none";
    }


</script>

</html>