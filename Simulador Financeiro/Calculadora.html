<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculadora Financeira</title>
</head>
<body>
    
    <label for="quantidade">Digite quantas salas de servidores tem no seu data center: </label>
    <input type="number" id="quantidade" onchange="gerarInput()"><br><br>

    <div id="inputs"></div>

    <button onclick="precificar()">Calcule seu orçamento</button>

    <div id="resultado"></div>

</body>
</html>

<script>

    var quantidadeSala = 0;
    
//   Função para gerar dinamicamente os inputs da calculadora
    function gerarInput(){
        this.quantidadeSala = Number(quantidade.value);
            inputs.innerHTML = ``;
            resultado.innerHTML = ``;
        for(var i = 0; i<quantidadeSala; i++){
            inputs.innerHTML += `
            <label for="quantidade">Digite a area da sala ${i+1}: </label>
            <input type="number" id="area${i+1}"><br><br>
            <label for="quantidade">Digite a quantidade de servidores da sala ${i+1}: </label>
            <input type="number" id="servidor${i+1}"><br><br>
            <label for="racks">Digite a quantidade de rack da sala ${i+1}: </label>
            <input type="number" id="rack${i+1}"><br><br>
            <label for="funcionarios">Quantos funcionários trabalham na sala ${i+1}: </label>
            <input type="number" id="funcionario${i+1}"><br><br>
            `
        }

    }

    //Função para realizar os calculos
    function precificar(){

        var somatorioArea = 0;
        var somatorioServidores = 0;
        var somatorioRacks = 0;
        var somatorioFuncionarios = 0;

        // Gerando as variáveis de forma dinâmica.
        for(var i = 0; i<quantidadeSala; i++){
            eval('var area_sala'+ (i+1) +'= ' + Number(eval('area' + (i+1) +".value")));
            eval('var servidor_sala'+ (i+1) +'= ' + Number(eval('servidor' + (i+1) +".value")));
            eval('var racks_sala'+ (i+1) +'= ' + Number(eval('rack' + (i+1) +".value")));
            eval('var funcionario_sala' + (i+1) + '= ' + Number(eval('funcionario' + (i+1) + ".value")));
        }

        // Armazenando os somatórios das variáveis
        for(var i = 0; i<quantidadeSala; i++){
            somatorioArea += eval("area_sala" + (i+1));
            somatorioServidores += eval("servidor_sala" + (i+1));
            somatorioRacks += eval("racks_sala" + (i+1));
            somatorioFuncionarios += eval("funcionario_sala" + (i+1));
        }


        var btuSala;
        //precisamos decidir um padrão para utilização dos sensores de umidade
        var quantidadeSensor =  somatorioRacks * 6;
        var quantidadeDesumidificador = Math.ceil( somatorioArea / 90);
        var quantidadeArCondicionado = 0;
        var valorDesumidificadores = quantidadeDesumidificador * 5000;
        var valorPlacaSensor = quantidadeSensor * 80;
        
        // Renderizando as informações para o usuário
        for(var i =0; i<quantidadeSala; i++){
            btuSala = eval("area_sala" + (i+1)) * 600 + eval("servidor_sala" + (i+1)) * 600 + eval("funcionario_sala" + (i+1)) * 600;
            quantidadeArCondicionado += Math.ceil(btuSala/120000)
            resultado.innerHTML += `Sua ${i+1}º sala de datacenter tem ${eval("area_sala" + (i+1))} m² de área, ${eval("servidor_sala" + (i+1))} servidores e ${eval("funcionario_sala" + (i+1))} funcionários, o que resulta na necessidade de ${btuSala} BTUs de potência para refrigerar efetivamente o ambiente, devido a esse fato iremos fornecer ${Math.ceil(btuSala/120000)} ar(es)-condicionado(s).<br>
            Devido à área de ${eval("area_sala" + (i+1))}m², a sala ${i+1} precisará de ${Math.ceil(eval("area_sala" + (i+1))/90)} desumidificador(es), já que nossos desumidificadores atuam efetivamente em uma área de 90m². <br>
            Devido à quantidade de ${eval("racks_sala" + (i+1))} racks na sala ${i+1}, será necessário ${(eval("racks_sala" + (i+1)) * 6)} sensores<br><br>
            `; 
        }

        
        var valorAresCondicionados = quantidadeArCondicionado * 30000;
        var precoTotal = valorAresCondicionados + valorDesumidificadores + valorPlacaSensor;

        resultado.innerHTML += `O preço total será de R$${precoTotal}, composto por um total de ${quantidadeArCondicionado} ar(es) condicionados que custarão R$${valorAresCondicionados}, ${quantidadeDesumidificador} desumidificador(es) que custarão R$${valorDesumidificadores},
        ${quantidadeSensor} sensores que custarão R$${valorPlacaSensor}.`;

    }

</script>